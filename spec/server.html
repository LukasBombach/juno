<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>Hello juno</h1>
    <script type="juno/component" juno-id="1"></script>
    <section>
      <label>23</label>
      <button>Click</button>
    </section>
    <hr />
    <script type="juno/component" juno-id="2"></script>
    <section>
      <label>5</label>
      <button>Click</button>
    </section>
    <!--
      Component ID = stable component ID, based on ast. You can change var and const names, and the hash will be the same.
      Hash can be used for caching!
    -->
    <script type="juno/data">
      {
        "1": { component: "_az4e", state: [23] },
        "2": { component: "_az4e", state: [5] }
      }
    </script>
    <script>
      const DATA = JSON.parse(document.querySelector('script[type="juno/data"]').textContent);

      function getInstances() {
        const markers = document.querySelectorAll('script[type="juno/component"]').map(marker => {
          const id = marker.getAttribute("juno-id");
          const { component, state } = DATA[id];
          const root = marker.nextElementSibling;
          return [component, state, root];
        });
      }

      function initWithState(component, state, root) {}

      getInstances().forEach(([component, state, root]) => initWithState(component, state, root));

      const Counter = (props, ssrContext) => {
        const [count, setCount] = useState(ssrContext.state[0]);
        const increment = () => setCount(count + 1);
        return [{ children: [count] }, { onClick: increment }];
      };

      const Counter2 = () => {
        const count = lazySignal(0);
        const increment = () => setCount(count() + 1);
        return [{ children: [() => dom.text.set(count)] }, { onClick: increment }];
      };
    </script>
  </body>
</html>
